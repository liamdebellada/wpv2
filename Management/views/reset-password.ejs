<script src="https://www.google.com/recaptcha/api.js" async defer></script>

<div class="row mt-5">
    <div class="col-md-6 m-auto">
      <div class="card card-body">
        <h4 class="text-center mb-3" style="font-weight: 400 !important;"><%= header %></h4>
        <h7 class="text-center"><%= subheader %></h7>
        <text id="reset-response" style="text-align: center; margin: 10px 0px"></text>
        <form action="/password-update" method="POST" style="">
          <div class="form-group">
            <label for="password">Password</label>
            <input id="aURL" name="aURL" value="<%= aURL %>" hidden></input>
            <input
              type="password"
              id="password"
              name="password"
              class="form-control"
              placeholder="Enter Password"
              required
            />
          </div>
          <div class="form-group">
            <label for="password">Confirm Password</label>
            <input
              type="password"
              id="confirm_password"
              name="password"
              class="form-control"
              placeholder="Enter Password"
              required
            />
          </div>
          <% if (tfaqr) { %>
          <div style="text-align: center; margin: 0 auto; margin-bottom: 1rem">

            <h6>Open your authenticator app and scan the QR Code.</h6>
            
            <img src="<%- tfaqr %>">

            <h6>Or alternatively, paste this <b>key</b> into your Authenticator App</h6>
            <text onClick="this.select()" style="font-size: 0.8175rem; color: white; background-color: #2b2b2b; padding: 4px"><%= tfakey %></text>
            
          </div>
        <% } else {}%>
          <div style="text-align: center;">
          <div class="g-recaptcha" style="display:inline-block; margin-bottom: 16px;" data-callback="checkComplete" data-sitekey="6LdqTLQZAAAAAMiaotVGuMyPr-FUhKNP6u_ARIr_"></div>
        </div>
          <button type="submit" class="btn btn-primary btn-block"><%= buttonText %></button>
        </form>
      </div>
    </div>
  </div>


  <script>
      var password = document.getElementById("password")
      confirm_password = document.getElementById("confirm_password");

      function validatePassword(){
      if(password.value != confirm_password.value) {
      confirm_password.setCustomValidity("Passwords Don't Match");
      } else {
      confirm_password.setCustomValidity('');
      }
      }

      password.onchange = validatePassword;
      confirm_password.onkeyup = validatePassword;
  </script>

  <style>
      .form {
          margin: 0 auto;
      }
      h6, img {
        -webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
      }
  </style>